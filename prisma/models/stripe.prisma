// ###################################################### SUBSCRIPTION ##########################################

enum SubscriptionStatus {
  incomplete
  incomplete_expired
  trialing
  active
  past_due
  canceled
  unpaid
  paused
}

enum Interval {
  day
  week
  month
  year
}

enum UsageType {
  metered
  licensed
}

model Subscription {
  subscription_id      String              @id
  user_id              String              @unique
  customer_id          String

  price_id             String?

  status               SubscriptionStatus  @default(incomplete)

  start_date           Int?
  trial_start          Int?
  trial_end            Int?
  ended_at             Int?
  cancel_at            Int?
  cancel_at_period_end Boolean             @default(false)

  // ----- Relations -----
  user                 User               @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
  price                Price?             @relation(fields: [price_id], references: [price_id])

  // ----- Timestamp -----
  created_at           Int?
  updated_at           Int?
  canceled_at          Int?
}

model Price {
  price_id                 String          @id

  currency                 String
  unit_amount              BigInt

  recurring_interval       Interval
  recurring_interval_count Int?            @default(1)
  recurring_usage_type     UsageType       @default(licensed)

  active                   Boolean         @default(false)

  // ----- Relations -----
  product_id               String
  product                  Product        @relation(fields: [product_id], references: [product_id])

  subscriptions            Subscription[]

  // ----- Timestamp -----
  created_at               DateTime        @default(now())
  updated_at               DateTime        @updatedAt
}

model Product {
  product_id  String    @id
  name        String
  description String?
  active      Boolean   @default(true)


  prices      Price[]

  // ----- Timestamp -----
  created_at  DateTime  @default(now())
  updated_at  DateTime  @updatedAt
}

