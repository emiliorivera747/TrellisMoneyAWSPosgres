enum SubscriptionStatus {
  incomplete
  incomplete_expired
  trialing
  active
  past_due
  canceled
  unpaid
  paused
}

enum Interval {
  day
  week
  month
  year
}

enum UsageType {
  metered
  licensed
}

model Subscription {
  subscription_id String @id
  user_id         String @unique
  customer_id     String

  price_id String?

  status SubscriptionStatus @default(incomplete)

  start_date           DateTime
  current_period_start DateTime
  current_period_end   DateTime

  trial_start DateTime?
  trial_end   DateTime?

  ended_at             DateTime?
  canceled_at          DateTime?
  cancel_at_period_end Boolean   @default(false)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  // Relations
  user  User   @relation(fields: [user_id], references: [user_id], onDelete: Cascade)
  price Price? @relation(fields: [price_id], references: [price_id])
}

model Price {
  price_id String @id

  product_id String

  currency    String
  unit_amount BigInt

  recurring_interval       Interval
  recurring_interval_count Int?      @default(1)
  recurring_usage_type     UsageType @default(licensed)

  active Boolean @default(false)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  // Relations
  product       Product        @relation(fields: [product_id], references: [product_id])
  subscriptions Subscription[]
}

model Product {
  product_id  String  @id
  name        String
  description String?
  active      Boolean @default(true)

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  prices Price[]
}
